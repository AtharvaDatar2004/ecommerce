<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width , initial-scale=1.0">
    <title>Cart - MyShop Store </title>
    <link rel="stylesheet" href="styling.css">
</head>

<body>

    <div class="small-container cart-page">
        <table id="cartTable">
            <tr>
                <th>Product</th>
                <th>Quantity</th>
                <th>Subtotal</th>
            </tr>
        </table>

        <hr><br>

        <div class="total-price">
            <table id="totalTable"></table>
            <br>
            <button onclick="goToCheckout()" class="btn">Proceed to Checkout</button>
        </div>
    </div>

    <script>
        function loadCart() {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            let table = document.getElementById("cartTable");
            let total = 0;

            cart.forEach((item, index) => {
                let subtotal = item.price * item.quantity;
                total += subtotal;

                let row = `<tr>
                    <td>
                        <div class="cart-info">
                            <img src="${item.image}" width="80" height="80">
                            <div>
                                <p>${item.name}</p>
                                <small>Price : ${item.price}Rs.</small>
                                <br>
                                <a href="#" onclick="removeItem(${index})">Remove</a>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" value="${item.quantity}" min="1" onchange="updateQuantity(${index}, this.value)"></td>
                    <td>${subtotal}Rs.</td>
                </tr>`;
                table.innerHTML += row;
            });

            let finalTotal = total + 50;

            document.getElementById("totalTable").innerHTML = `
                <tr><td>Subtotal</td><td>${total}Rs.</td></tr>
                <tr><td>Tax</td><td>50Rs.</td></tr>
                <tr><td>Total</td><td>${finalTotal}Rs.</td></tr>
            `;

            localStorage.setItem("finalTotal", finalTotal);
        }

        function goToCheckout() {
            window.location.href = "checkout.html";
        }

        function removeItem(index) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart.splice(index, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            location.reload();
        }

        function updateQuantity(index, qty) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart[index].quantity = parseInt(qty);
            localStorage.setItem("cart", JSON.stringify(cart));
            location.reload();
        }

        loadCart();
    </script>

</body>
</html>
